#!/bin/bash
SHARE='/home/share'

p(){
  style=${2:-"1;31"}
  echo -e "\e[${style}m${1}\e[m"
}

# Installation
echo -e '\e[40m'
echo '      ğŸ“‚ğŸ“‚ğŸ“‚                                                                                  '
echo '  ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚                                                                                '
echo 'ğŸ“‚ğŸ“‚        ğŸ“‚ğŸ“‚                                            ğŸ“‚                                '
echo 'ğŸ“‚ğŸ“‚          ğŸ“‚                                            ğŸ“‚                                '
echo 'ğŸ“‚ğŸ“‚          ğŸ“‚                                            ğŸ“‚                                '
echo '  ğŸ“‚ğŸ“‚                  ğŸ“‚ğŸ“‚          ğŸ“‚ğŸ“‚                  ğŸ“‚ğŸ“‚                  ğŸ“‚ğŸ“‚        '
echo '    ğŸ“‚ğŸ“‚ğŸ“‚          ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚        ğŸ“‚ğŸ“‚  ğŸ“‚    ğŸ“‚        ğŸ“‚ğŸ“‚  ğŸ“‚          ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚      '
echo '        ğŸ“‚ğŸ“‚ğŸ“‚      ğŸ“‚      ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚      ğŸ“‚      ğŸ“‚ğŸ“‚    '
echo '          ğŸ“‚ğŸ“‚ğŸ“‚        ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚  ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚        ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚    '
echo '            ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚    ğŸ“‚    ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚    '
echo 'ğŸ“‚            ğŸ“‚    ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚    ğŸ“‚    ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚    '
echo 'ğŸ“‚ğŸ“‚        ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚    ğŸ“‚    ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚ğŸ“‚  ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚ğŸ“‚  '
echo '  ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚      ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚  ğŸ“‚ğŸ“‚  ğŸ“‚ğŸ“‚    ğŸ“‚    ğŸ“‚ğŸ“‚    ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚        ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚  ğŸ“‚ğŸ“‚'
echo '    ğŸ“‚ğŸ“‚ğŸ“‚ğŸ“‚                                                                                  '
echo -e '\e[m'

p 'Install'
sudo apt update
sudo apt install samba

if [ ! -e ${SHARE} ]; then
    p "make dir ${SHARE}"
    sudo mkdir ${SHARE} && sudo chmod 777 ${SHARE}
fi

p 'Add Configrations'

CONFIG="
interfaces = 10.0.2.0/24
bind interfaces only = yes
map to guest = Bad User
# ä»»æ„ã®å…±æœ‰åã‚’æŒ‡å®š
[Share]
    # å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®š
    path = ${SHARE}
    # æ›¸ãè¾¼ã¿OK
    writable = yes
    # ã‚²ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼OK
    guest ok = yes
    # å…¨ã¦ã‚²ã‚¹ãƒˆã¨ã—ã¦æ‰±ã†
    guest only = yes
    # ãƒ•ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã§ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
    create mode = 0777
    # ãƒ•ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã§ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ
    directory mode = 0777
"
p "${CONFIG}" '90'
sudo bash -c "cat << EOF >> /etc/samba/smb.conf ${CONFIG}EOF"

sudo systemctl restart smbd